<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teacher Dashboard - Fountain School</title>
<style>
body{font-family:Arial,sans-serif;background:#f4f4f4;margin:0;padding:0;}
nav{background:#2c3e50;color:#fff;padding:10px;display:flex;gap:15px;}
nav a{color:#fff;text-decoration:none;}
nav a:hover{text-decoration:underline;}
.container{max-width:600px;margin:50px auto;background:#fff;padding:20px;box-shadow:0 0 10px rgba(0,0,0,0.2);}
button{padding:8px 15px;margin:5px;cursor:pointer;}
</style>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey:"YOUR_API_KEY",
  authDomain:"transport-35437.firebaseapp.com",
  projectId:"transport-35437",
  storageBucket:"transport-35437.appspot.com",
  messagingSenderId:"495834194048",
  appId:"1:495834194048:web:a9322dee4cd1d137280665"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const logoutBtn = document.getElementById('logoutBtn');
const infoDiv = document.getElementById('teacherInfo');
const acceptBtn = document.getElementById('acceptBtn');
const endBtn = document.getElementById('endBtn');

let currentTeacherId;

onAuthStateChanged(auth,async user=>{
  if(user){
    const docRef = doc(db,'teachers',user.uid);
    const docSnap = await getDoc(docRef);
    if(docSnap.exists()){
      const data = docSnap.data();
      currentTeacherId = user.uid;
      infoDiv.innerHTML=`
        <p><strong>Name:</strong> ${data.name}</p>
        <p><strong>Class:</strong> ${data.class}</p>
        <p><strong>Phone:</strong> ${data.phone}</p>
        <p><strong>Bus:</strong> ${data.bus || 'Free'}</p>
        <p><strong>Route:</strong> ${data.route || 'Free'}</p>
      `;
      if(!data.bus)data.message='You are free today, no route assigned';
    } else { alert('Teacher data not found'); }
  } else { window.location.href='index.html'; }
});

logoutBtn.addEventListener('click',()=>signOut(auth).then(()=>window.location.href='index.html'));

acceptBtn.addEventListener('click',async ()=>{
  if(!currentTeacherId)return;
  await updateDoc(doc(db,'teachers',currentTeacherId),{accepted:true});
  alert("You accepted your shift!");
});

endBtn.addEventListener('click',async ()=>{
  if(!currentTeacherId)return;
  await updateDoc(doc(db,'teachers',currentTeacherId),{accepted:false,shiftDone:true});
  alert("Shift ended!");
});
</script>
</head>
<body>
<nav>
<a href="#">Home</a>
<a href="routes.html">Routes</a>
<a href="buses.html">Buses</a>
<a href="about.html">About</a>
<a href="contact.html">Contact</a>
<a href="#" id="logoutBtn">Logout</a>
</nav>

<div class="container">
<h2>Teacher Dashboard</h2>
<div id="teacherInfo"></div>
<button id="acceptBtn">I Accept</button>
<button id="endBtn">End Shift</button>
</div>
</body>
</html>




